var _=require("underscore");_.str=require("underscore.string"),_.mixin(_.str.exports()),_.str.include("Underscore.string","string");var natural=require("natural"),Corpus=function(a){var b=this;this.documents=a,this.clean=function(){return b.documents=b.documents.map(function(a){return _.clean(a)}),b},this.trim=function(){return b.documents=this.documents.map(function(a){return _.trim(a)}),b},this.inspect=function(a){void 0===a&&(a=200),b.documents.forEach(function(b,c){console.log("Document "+c+":"),console.log(_(b).truncate(a)),console.log("─ ─ ─ ─ ─")})},this.toLower=function(){return b.documents=b.documents.map(function(a){return a.toLowerCase()}),b},this.toUpper=function(){return b.documents=b.documents.map(function(a){return a.toUpperCase()}),b},this.stem=function(a){return b.documents=b.documents.map(function(b){return"Lancaster"==a?natural.LancasterStemmer.stem(b):natural.PorterStemmer.stem(b)}),b},this.map=function(a){return b.documents=_corpus.documents.map(a),b},this.removeWords=function(a,c){for(var d=0;d<b.documents.length;d++)for(var e=0;e<a.length;e++){var f=c?"":"i",g=new RegExp("\\b"+a[e]+"\\b",f);b.documents[d]=b.documents[d].replace(g,"")}return b},this.removeInterpunctuation=function(){return b.documents=b.documents.map(function(a){return a.replace(/[\!\?\.,;-]/g," ")}),b},this.stripWhitespace=function(){return b.documents=b.documents.map(function(a){return a.replace(/ +/g," ")}),b}};exports.Corpus=Corpus;;var Terms=function(a){var b=this;this.vocabulary=[],this.dtm=[];var c=function(a){for(var c=a.split(" "),d=[],e=0;e<c.length;e++){var f=c[e],g=b.vocabulary.indexOf(f);g>-1?d[g]+=1:(d[b.vocabulary.length]=1,b.vocabulary.push(f))}b.dtm.push(d)};this.removeSparseTerms=function(a){for(var c=0;c<b.vocabulary.length;c++){for(var d=0,e=0;e<b.dtm.length;e++){var f=b.dtm[e];void 0!==f&&void 0!==f[c]&&(d++,console.log("counter hochgezaehl"))}if(d/b.dtm.length<a){b.vocabulary=b.vocabulary.splice(c,1);for(var g=0;g<b.dtm.length;g++)void 0!==b.dtm[g]&&(b.dtm[g]=b.dtm[g].splice(c,.1))}}return b},function(){var b=a.documents;b.forEach(c)}()};exports.Terms=Terms;